# 操作系统

- [操作系统](#操作系统)
  - [整体情况](#整体情况)
  - [进程管理](#进程管理)
    - [操作系统概述](#操作系统概述)
    - [进程组成和状态](#进程组成和状态)
    - [前趋图](#前趋图)
    - [进程资源图](#进程资源图)
    - [进程同步和互斥](#进程同步和互斥)
    - [进程调度](#进程调度)
    - [死锁](#死锁)
    - [线程](#线程)
  - [存储管理](#存储管理)
    - [分区存储管理](#分区存储管理)
    - [分页存储管理](#分页存储管理)
    - [分段存储管理](#分段存储管理)
    - [段页式存储管理](#段页式存储管理)
  - [设备管理](#设备管理)
    - [设备管理概述](#设备管理概述)
    - [I/O软件](#io软件)
    - [设备管理技术](#设备管理技术)
  - [文件管理](#文件管理)
    - [文件管理概述](#文件管理概述)
    - [索引文件结构](#索引文件结构)
    - [文件目录](#文件目录)
    - [文件存储空间管理](#文件存储空间管理)


## 整体情况
每年都考3-5分左右。

## 进程管理

### 操作系统概述
操作系统定义:能有效地组织和管理系统中的各种软/硬件资源,合理地组织计算机系统工作流程,控制程序的执行,并且向用户提供一个良好的工作昨环境和友好的接口。

操作系统有三个**重要的作用**:
- 第一,管理计算机中运行的程序和分配各种软硬件资源;
- 第二,为用户提供友善的人机界面。
- 第三,为应用程序的开发和运行提供一个高效率的平台。

操作系统的4个特征是**并发性、共享性、虚拟性和不确定性（异步性）**。

**操作系统的功能:**
- (1)**进程管理**。实质上是对处理机的执行"时间"进行管理,采用多道程序等技术将CPU的时间合理地分配给每个任务,主要包括进程控制、进程同步、进程通信和进程调度。
- (2)**文件管理**。主要包括文件存储空间管理、目录管理、文件的读/写管理和存取控制。
- (3)**存储管理**。存储管理是对主存储器"空间"进行管理,主要包括存储分配与回收、存储保护、地址映射(变换)和主存扩充。
- (4)**设备管理**。实质是对硬件设备的管理,包括对输入/输出设备的分配配启动、完成和回收。
- (5)**作业管理**。包括任务、界面管理、人机交互、图形界面、语音控制和虚拟现实等。

操作系统的分类:
- **批处理操作系统**:单道批处理和多道批处理(主机与外设可并行)。
- **分时操作系统**:一个计算机系统与多个终端设备连接。将CPU的工作时间划分为许多很短的时间片,轮流为各个终端的用户服务。
- **实时操作系统**:实时是指计算机对于外来信息能够以足够快的速度进进行处理并在被控对象允许的时间范围内做出快速反应。实时系统对交互能力要求不高,但要求可靠性有保障。
- **网络操作系统**:是使联网计算机能方便而有效地共享网络资源,为网络用户提供各种服务的软件和有关协议的集合。三种模式:集中模式、客户端/服务器模式、对等模式。
- **分布式操作系统**:分布式计算机系统是由多个分散的计算机经连接而成的计算机系统,系统中的计算机无主、次之分,任意两台计算机可以通过通信交换信息。
- **微型计算机操作系统**:简称微机操作系统,常用的有Winddows、Mac OS,Linux。

嵌入式操作系统主要特点:
- (1)**微型化**。从性能和成本角度考虑,希望占用的资源和系统代码量少,如内存少、字长短、运行速度有限、能源少(用微小型电池)。
- (2)**可定制**。从减少成本和缩短研发周期考虑,要求嵌入式操作系统能运行在不同的微处理器平台上,能针对硬件变化进行结构与功能上的的配置,以满足不同应用需要。
- (3)**实时性**。嵌入式操作系统主要应用于过程控制、数据采集、传输通信、多媒体信息及关键要害领域需要迅速响应的场合,所以对实时性要求较高。
- (4)**可靠性**。系统构件、模块和体系结构必须达到应有的可靠性,对关键要害应用还要提供容错和防故障措施。
- (5)**易移植性**。为了提高系统的易移植性,通常采用硬件抽象层和板级支撑包的底层设计技术。

嵌入式系统**初始化**过程按照自底向上、从硬件到软件的次序依次为:**片级初始化（芯片级别）→板级初始化（各种外设）→系统初始化**。

### 进程组成和状态
**进程的组成**:进程控制块PCB(唯一标志)、程序(描述进程要做什么)、数据(存放进程执行时所需数据)。

进程基础的状态是下左图中的**三态图**。需要**熟练掌握左下图中的的进程三态之间的转换**。
![进程三态图](./imgs/02-process-status.png)

### 前趋图
用来表示哪些任务可以并行执行,哪些任务之间有顺序关系,具体如下图:可知,ABC可以并行执行,但是必须ABC都执行完后,才能执行D,这就确定了两点:**任务间的并行、任务间的先后顺序**。
![前趋图](./imgs/02-process-qianqu.png)

### 进程资源图
用来表示**进程和资源之间的分配和请求关系**,如下图所示:
![进程资源图](./imgs/02-process-resource.png)

**P代表进程,R代表资源**,R方框中有几个圆球就表示有几个这冲资源,在上图中,R1指向P1,表示R1有一个资源已经分配给了P1,P1指向R2,表示P1还需要请求一个R2资源才能执行。

阻塞节点:某进程**所请求的资源已经全部分配完毕**,无法获取所需资源,该进程被阻塞了无法继续。如上图中P2。

非阻塞节点:某进程所请求的资源还有剩余,可以分配给该进程继续运行。
如上图中P1、P3。

当一个进程资源图中所有进程都是阻塞节点时,即陷入死锁状态。

### 进程同步和互斥

- 临界资源:**各进程间需要以互斥方式对其进行访问**的资源。
- 临界区:指进程中**对临界资源实施操作的那段程序**。本质是一段程序代码。
- 互斥:某资源(即临界资源)在**同一时间内只能由一个任务单独使用**,使用时需要加锁,使用完后解锁才能被其他任务使用;如打印机。
- 同步:**多个任务可以并发执行,只不过有速度上的差异**,在一定情况下停下等待,不存在资源是否单独或共享的问题;如自行车和汽车。
- 互斥信号量:对临界资源采用互斥访问,使用互斥信号量后其他进程无法访问,**初值为1。**
- 同步信号量:对共享资源的访问控制,**初值一般是共享资源的数量**。

- **P操作:申请资源,S=S-1**,若S>=0,则执行P操作的进程继续执行;若s<0,则置该进程为阻塞状态(因为无可用资源),并将其插入阻塞队列。
- **V操作:释放资源,S=S+1**,若S>0,则执行V操作的进程继续执行若s<=0,则从阻塞状态唤醒一个进程,并将其插入就绪队列(此时因为缺少资源被P操作阻塞的进程可以继续执行),然后执行V操作的进程继续。
![PV操作](./imgs/02-p&v.png)

经典问题:**生产者和消费者的问题**

三个信号量:互斥信号量S0(仓库独立使用权),同步信号量s1(仓库空闲个数),同步信号量S2(仓库商品个数)。
![PV操作-生产者-消费者](./imgs/02-p&v-1.png)

### 进程调度
### 死锁
### 线程

## 存储管理
### 分区存储管理
### 分页存储管理
### 分段存储管理
### 段页式存储管理

## 设备管理
### 设备管理概述
### I/O软件
### 设备管理技术

## 文件管理
### 文件管理概述
### 索引文件结构
### 文件目录
### 文件存储空间管理